@using TeamWorkApp.Models
@using TaskStatus = TeamWorkApp.Models.TaskStatus
@model IEnumerable<TeamWorkApp.Models.Task>

@{
    ViewBag.Title = "Seznam opravil";
    
    var newTasks = Model.Where(x => x.TaskStatus.Equals(TaskStatus.New));
    var inProgressTask = Model.Where(x => x.TaskStatus.Equals(TaskStatus.InProgress));
    var completedTasks = Model.Where(x => x.TaskStatus.Equals(TaskStatus.Completed));
}

<h2>@ViewBag.Title</h2>

<p>
    @Html.ActionLink("Dodaj opravilo", "Create")
</p>

<div class="row">
    <div class="col-xs-12 col-sm-4">
        @foreach (var item in newTasks)
        {
            var taskName = $"Task_{item.TaskID}";
        
            <div class="task-card-wrapper">
                <a href="@Url.Action("Edit", "Task", new { id = item.TaskID })">
                    <div>@taskName</div>
                    <div>@item.TaskDescription</div>
                    <div>
                        @foreach (var x in item.TeamMembers)
                        {
                            <span>@x.Name</span>
                            if (x != item.TeamMembers.LastOrDefault())
                            {
                                <span>|</span>
                            }
                        }
                    </div>
                </a>
            </div>
        }
    </div>
    <div class="col-xs-12 col-sm-4">
        @foreach (var item in inProgressTask)
        {
            var taskName = $"Task_{item.TaskID}";

            <div class="task-card-wrapper">
                <a href="@Url.Action("Edit", "Task", new { id = item.TaskID })">
                    <div>@taskName</div>
                    <div>@item.TaskDescription</div>
                    <div>
                        @foreach (var x in item.TeamMembers)
                        {
                            <span>@x.Name</span>
                            if (x != item.TeamMembers.LastOrDefault())
                            {
                                <span>|</span>
                            }
                        }
                    </div>
                </a>
            </div>
            
        }
    </div>
    <div class="col-xs-12 col-sm-4">
        @foreach (var item in completedTasks)
        {
            var taskName = $"Task_{item.TaskID}";
            <div class="task-card-wrapper">
                <a href="@Url.Action("Edit", "Task", new { id = item.TaskID })">
                    <div>@taskName</div>
                    <div>@item.TaskDescription</div>
                    <div>
                        @foreach (var x in item.TeamMembers)
                        {
                            <span>@x.Name</span>
                            if (x != item.TeamMembers.LastOrDefault())
                            {
                                <span>|</span>
                            }
                        }
                    </div>
                </a>
            </div>
        }
    </div>

</div>